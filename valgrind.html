<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Valgrind &mdash; PHY 504 Spring 2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=851f9797" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=60df5cae"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script src="_static/design-tabs.js?v=36754332"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Debugging" href="debugging.html" />
    <link rel="prev" title="Convergence Testing" href="cxx-convergence-tests.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PHY 504
          </a>
              <div class="version">
                Spring 2024
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Intro &amp; Logistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics.html">Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="computing.html">Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hello_world.html">Hello, World</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The UNIX Shell</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="why_command_line.html">Why Use the Command Line?</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell.html">Navigating the Filesystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell-2.html">Create Files and Directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell-3.html">Redirection and Pipes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Git and Version Control</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="version_control.html">Version Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell-setup.html">Dotfiles and the Mathlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="git.html">A Git Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-branches.html">Git Branches</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-remotes.html">Git Remotes</a></li>
<li class="toctree-l1"><a class="reference internal" href="github.html">github</a></li>
<li class="toctree-l1"><a class="reference internal" href="pull-requests.html">Pull Requests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Shell Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="shell-looping.html">Looping on the Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell-scripts.html">Shell Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="permissions.html">File Permissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="finding.html">Find and Grep</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="book.html">C++ Textbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware.html">Computer Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="development-tools.html">Software Development Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">Structure of a C++ Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Helpful C++ Tools / Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling.html">Compiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="editors.html">Editors</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_project.html">A First C++ Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++ Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cxx-datatypes.html">C++ Datatypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-vectors.html">Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-more-vectors.html">More Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-matrix-example.html">Example: Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-sequence-containers.html">Aside: Sequence Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-strings.html">Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-auto-decltype.html"><code class="docutils literal notranslate"><span class="pre">auto</span></code> and <code class="docutils literal notranslate"><span class="pre">decltype</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-structs.html">Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-arrays.html">Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-pointers.html">Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-statements.html">Loops and If-Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-maps.html">Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-io.html">File I/O</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cxx-functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-functions-example.html">More Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-orbit-example.html">Example: Planetary Orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="inclass-rk2-orbit.html">In Class: 2nd Order Runge-Kutta Orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-lambdas.html">Lambda Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-functions-planets.html">Example: Sorting Planets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Elements of Software Engineering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="compiler-flags.html">Making the Compiler Do the Work</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple-files.html">Working with Multiple Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="make.html">Makefiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="inclass-split-orbit.html">In-Class Example: Splitting Up Our Orbit Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cxx-classes-intro.html">Introduction to Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="object-oriented.html">Object-Oriented Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="inclass-class-example.html">In-Class Example: A Simple Grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-vector2d-class.html">Example: Mathematical Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="inclass-orbit-class.html">In-Class Example: Orbit Integrator Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="contiguous_array.html">Example: Multidimensional Contiguous Array</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Some Random Bits...</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cxx-mdspan.html">Preview: C++23 mdspan</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-enumerate-zip.html">Preview: C++23 enumerate and zip</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-enum.html">enum</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-casting.html">Casting</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-iomanip.html">I/O Manipulators</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-print.html">Preview: C++23 Print</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-filesystem.html">Filesystem Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="floating-point.html">Floating Point</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Testing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-unit-tests.html">Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-convergence-tests.html">Convergence Testing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Valgrind</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#uninitialized-variables">Uninitialized variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bounds-checking">Bounds checking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="clang-tidy.html">clang-tidy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Digging Deeper into C++ Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="inheritance-and-access.html">Inheritance and Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="this-class.html"><code class="docutils literal notranslate"><span class="pre">this</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="copy_and_assignment.html">Copy, Assignment, and Destructors</a></li>
<li class="toctree-l1"><a class="reference internal" href="compound-operators.html">Compound Assignment Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="inclass-orbit-compound.html">In-Class Example: Orbit Integrator Compound Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-move.html">Move Semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-allocating.html">Allocating Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-simple-container.html">Example: A Simple Container</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documenting Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="html-css.html">HTML + CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="github-pages.html">Github Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="doxygen.html">Doxygen</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx.html">Sphinx</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Templates</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="templates-intro.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-template-array.html">Example: Templated Array</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates-more.html">More On Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-constexpr.html"><code class="docutils literal notranslate"><span class="pre">constexpr</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="functionals.html">Function Objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Some Numerical Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="roots.html">Root Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="monte-carlo.html">Monte Carlo Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="poisson-relax.html">Poisson Equation and Relaxation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parallel Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parallel-intro.html">Introduction to Parallel Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="trivially-parallel.html">Trivially Parallel + BASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmp-intro.html">OpenMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmp-relax.html">OpenMP Poisson Relaxation</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmp-pi.html">OpenMP Monte Carlo <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi-intro.html">MPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi-sendrecv.html">MPI Send and Receive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">To Be Continued...</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="didnt_cover.html">Stuff We Didn’t Cover</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx20.html">Coming in C++20</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx23.html">Coming in C++23</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-glossary.html">Some C++ programming terms</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Homework</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="homework/homework1.html">Homework 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="homework/homework2.html">Homework 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="homework/homework3.html">Homework 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="homework/homework4.html">Homework 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="homework/homework5.html">Homework 5</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="project.html">Final Project</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PHY 504</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Valgrind</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/valgrind.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="valgrind">
<h1>Valgrind<a class="headerlink" href="#valgrind" title="Link to this heading"></a></h1>
<p><a class="reference external" href="https://valgrind.org/">Valgrind</a> is a tool that can detect memory
leaks, using uninitialized variables, In essence, valgrind translates
the executable to an intermediate, architecture-independent form, and
the tools in valgrind interpret this code.  As a result, it can
instrument the code with a lot of different checks, but this comes at
a performance cost.</p>
<p>Usually you will run your code through valgrind even if there are no
apparently bugs, just to ensure that you didn’t miss anything.  If you
know you have bugs, valgrind can help you find them.</p>
<p>We have not (yet) been doing manually memory management (because
modern C++ really makes it rare that we need to), so this greatly
reduces our chance of memory leaks.  But if we did, valgrind would be
able to tell us if we didn’t free up any memory.</p>
<section id="uninitialized-variables">
<h2>Uninitialized variables<a class="headerlink" href="#uninitialized-variables" title="Link to this heading"></a></h2>
<p>Consider the following example:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-number">Listing 80 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">uninitialized.cpp</span></code></span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">   </span><span class="c1">// uninitialized</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<p>here we are using the object <code class="docutils literal notranslate"><span class="pre">b</span></code> without initializing it.  If we run this directly,
the code seems to work.  Now if we instead run it via valgrind:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: " ";
}
</style><span class="prompt1">g++ -g -o uninitialized uninitialized.cpp</span>
<span class="prompt1">valgrind ./uninitialized</span>
</pre></div></div><p>we see that there are errors.  Here’s the first:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==</span><span class="mi">1457506</span><span class="o">==</span> <span class="n">Conditional</span> <span class="n">jump</span> <span class="ow">or</span> <span class="n">move</span> <span class="n">depends</span> <span class="n">on</span> <span class="n">uninitialised</span> <span class="n">value</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>    <span class="n">at</span> <span class="mh">0x4BDC2C8</span><span class="p">:</span> <span class="n">__printf_fp_l</span> <span class="p">(</span><span class="n">printf_fp</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">397</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4BF5FF7</span><span class="p">:</span> <span class="n">__vfprintf_internal</span> <span class="p">(</span><span class="n">vfprintf</span><span class="o">-</span><span class="n">internal</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">1646</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4C06CD9</span><span class="p">:</span> <span class="n">__vsnprintf_internal</span> <span class="p">(</span><span class="n">vsnprintf</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">114</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x49664F2</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">__convert_from_v</span><span class="p">(</span><span class="n">__locale_struct</span><span class="o">*</span> <span class="n">const</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">char</span> <span class="n">const</span><span class="o">*</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="p">(</span><span class="n">c</span><span class="o">++</span><span class="n">locale</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">92</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4996400</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">ostreambuf_iterator</span><span class="o">&lt;</span><span class="n">char</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">std</span><span class="p">::</span><span class="n">num_put</span><span class="o">&lt;</span><span class="n">char</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">ostreambuf_iterator</span><span class="o">&lt;</span><span class="n">char</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">::</span><span class="n">_M_insert_float</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">ostreambuf_iterator</span><span class="o">&lt;</span><span class="n">char</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">ios_base</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">double</span><span class="p">)</span> <span class="n">const</span> <span class="p">(</span><span class="n">locale_facets</span><span class="o">.</span><span class="n">tcc</span><span class="p">:</span><span class="mi">1023</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x49A4B4F</span><span class="p">:</span> <span class="n">put</span> <span class="p">(</span><span class="n">locale_facets</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">2458</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x49A4B4F</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">std</span><span class="p">::</span><span class="n">ostream</span><span class="p">::</span><span class="n">_M_insert</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">double</span><span class="p">)</span> <span class="p">(</span><span class="n">ostream</span><span class="o">.</span><span class="n">tcc</span><span class="p">:</span><span class="mi">73</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x401313</span><span class="p">:</span> <span class="n">main</span> <span class="p">(</span><span class="n">uninitialized</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">16</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457506</span><span class="o">==</span>
</pre></div>
</div>
<p>That’s where we use the resulting vector, but the tool also tells us to turn on <code class="docutils literal notranslate"><span class="pre">--track-origins=yes</span></code> to see
where the problem first arises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt2:before {
  content: "$ ";
}
</style><span class="prompt2">valgrind<span class="w"> </span>--track-origins<span class="o">=</span>yes<span class="w"> </span>./uninitialized</span>
</pre></div></div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==</span><span class="mi">1457650</span><span class="o">==</span> <span class="n">Conditional</span> <span class="n">jump</span> <span class="ow">or</span> <span class="n">move</span> <span class="n">depends</span> <span class="n">on</span> <span class="n">uninitialised</span> <span class="n">value</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">at</span> <span class="mh">0x4BDC2C8</span><span class="p">:</span> <span class="n">__printf_fp_l</span> <span class="p">(</span><span class="n">printf_fp</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">397</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4BF5FF7</span><span class="p">:</span> <span class="n">__vfprintf_internal</span> <span class="p">(</span><span class="n">vfprintf</span><span class="o">-</span><span class="n">internal</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">1646</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4C06CD9</span><span class="p">:</span> <span class="n">__vsnprintf_internal</span> <span class="p">(</span><span class="n">vsnprintf</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">114</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x49664F2</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">__convert_from_v</span><span class="p">(</span><span class="n">__locale_struct</span><span class="o">*</span> <span class="n">const</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">char</span> <span class="n">const</span><span class="o">*</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="p">(</span><span class="n">c</span><span class="o">++</span><span class="n">locale</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">92</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4996400</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">ostreambuf_iterator</span><span class="o">&lt;</span><span class="n">char</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">std</span><span class="p">::</span><span class="n">num_put</span><span class="o">&lt;</span><span class="n">char</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">ostreambuf_iterator</span><span class="o">&lt;</span><span class="n">char</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">::</span><span class="n">_M_insert_float</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">ostreambuf_iterator</span><span class="o">&lt;</span><span class="n">char</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">ios_base</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">double</span><span class="p">)</span> <span class="n">const</span> <span class="p">(</span><span class="n">locale_facets</span><span class="o">.</span><span class="n">tcc</span><span class="p">:</span><span class="mi">1023</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x49A4B4F</span><span class="p">:</span> <span class="n">put</span> <span class="p">(</span><span class="n">locale_facets</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">2458</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x49A4B4F</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">std</span><span class="p">::</span><span class="n">ostream</span><span class="p">::</span><span class="n">_M_insert</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">double</span><span class="p">)</span> <span class="p">(</span><span class="n">ostream</span><span class="o">.</span><span class="n">tcc</span><span class="p">:</span><span class="mi">73</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x401313</span><span class="p">:</span> <span class="n">main</span> <span class="p">(</span><span class="n">uninitialized</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">16</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>  <span class="n">Uninitialised</span> <span class="n">value</span> <span class="n">was</span> <span class="n">created</span> <span class="n">by</span> <span class="n">a</span> <span class="n">stack</span> <span class="n">allocation</span>
<span class="o">==</span><span class="mi">1457650</span><span class="o">==</span>    <span class="n">at</span> <span class="mh">0x401226</span><span class="p">:</span> <span class="n">main</span> <span class="p">(</span><span class="n">uninitialized</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>Now it is telling us that the uninitialized variable is on the stack.  In our code, <code class="docutils literal notranslate"><span class="pre">b</span></code> is the only stack
variable.</p>
</section>
<section id="bounds-checking">
<h2>Bounds checking<a class="headerlink" href="#bounds-checking" title="Link to this heading"></a></h2>
<p>Consider the following code:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-number">Listing 81 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">bounds.cpp</span></code></span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">};</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here, we are accessing the <code class="docutils literal notranslate"><span class="pre">vector</span> <span class="pre">a</span></code> out of bounds.  When we just run it on the command line, it works fine.</p>
<p>When we run it through valgrind, we see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt2">g++<span class="w"> </span>-g<span class="w"> </span>-o<span class="w"> </span>bounds<span class="w"> </span>bounds.cpp</span>
<span class="prompt2">valgrind<span class="w"> </span>./bounds</span>
</pre></div></div><p>we see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==</span><span class="mi">1458835</span><span class="o">==</span> <span class="n">Invalid</span> <span class="n">read</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>    <span class="n">at</span> <span class="mh">0x401281</span><span class="p">:</span> <span class="n">main</span> <span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>  <span class="n">Address</span> <span class="mh">0x4da4c94</span> <span class="ow">is</span> <span class="mi">0</span> <span class="nb">bytes</span> <span class="n">after</span> <span class="n">a</span> <span class="n">block</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">20</span> <span class="n">alloc</span><span class="s1">&#39;d</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>    <span class="n">at</span> <span class="mh">0x4844FF5</span><span class="p">:</span> <span class="n">operator</span> <span class="n">new</span><span class="p">(</span><span class="n">unsigned</span> <span class="n">long</span><span class="p">)</span> <span class="p">(</span><span class="n">vg_replace_malloc</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">422</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x401A17</span><span class="p">:</span> <span class="n">__gnu_cxx</span><span class="p">::</span><span class="n">new_allocator</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">::</span><span class="n">allocate</span><span class="p">(</span><span class="n">unsigned</span> <span class="n">long</span><span class="p">,</span> <span class="n">void</span> <span class="n">const</span><span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">new_allocator</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">127</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4018DD</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">allocator_traits</span><span class="o">&lt;</span><span class="n">std</span><span class="p">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">::</span><span class="n">allocate</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;&amp;</span><span class="p">,</span> <span class="n">unsigned</span> <span class="n">long</span><span class="p">)</span> <span class="p">(</span><span class="n">alloc_traits</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">464</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x401791</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">_Vector_base</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">::</span><span class="n">_M_allocate</span><span class="p">(</span><span class="n">unsigned</span> <span class="n">long</span><span class="p">)</span> <span class="p">(</span><span class="n">stl_vector</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">346</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4015DE</span><span class="p">:</span> <span class="n">void</span> <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">::</span><span class="n">_M_range_initialize</span><span class="o">&lt;</span><span class="nb">int</span> <span class="n">const</span><span class="o">*&gt;</span><span class="p">(</span><span class="nb">int</span> <span class="n">const</span><span class="o">*</span><span class="p">,</span> <span class="nb">int</span> <span class="n">const</span><span class="o">*</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">forward_iterator_tag</span><span class="p">)</span> <span class="p">(</span><span class="n">stl_vector</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">1582</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x4013DE</span><span class="p">:</span> <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">::</span><span class="n">vector</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">initializer_list</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">const</span><span class="o">&amp;</span><span class="p">)</span> <span class="p">(</span><span class="n">stl_vector</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">629</span><span class="p">)</span>
<span class="o">==</span><span class="mi">1458835</span><span class="o">==</span>    <span class="n">by</span> <span class="mh">0x401263</span><span class="p">:</span> <span class="n">main</span> <span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>This shows us that on line 8, we did an invalid read of size 4 (bytes).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cxx-convergence-tests.html" class="btn btn-neutral float-left" title="Convergence Testing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="debugging.html" class="btn btn-neutral float-right" title="Debugging" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2024, Michael Zingale.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>