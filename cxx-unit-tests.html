<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unit Testing &mdash; PHY 504 Spring 2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=851f9797" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=60df5cae"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script src="_static/design-tabs.js?v=36754332"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Convergence Testing" href="cxx-convergence-tests.html" />
    <link rel="prev" title="Testing" href="testing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PHY 504
          </a>
              <div class="version">
                Spring 2024
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Intro &amp; Logistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics.html">Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="computing.html">Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hello_world.html">Hello, World</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The UNIX Shell</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="why_command_line.html">Why Use the Command Line?</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell.html">Navigating the Filesystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell-2.html">Create Files and Directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell-3.html">Redirection and Pipes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Git and Version Control</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="version_control.html">Version Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell-setup.html">Dotfiles and the Mathlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="git.html">A Git Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-branches.html">Git Branches</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-remotes.html">Git Remotes</a></li>
<li class="toctree-l1"><a class="reference internal" href="github.html">github</a></li>
<li class="toctree-l1"><a class="reference internal" href="pull-requests.html">Pull Requests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Shell Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="shell-looping.html">Looping on the Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell-scripts.html">Shell Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="permissions.html">File Permissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="finding.html">Find and Grep</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="book.html">C++ Textbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware.html">Computer Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="development-tools.html">Software Development Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">Structure of a C++ Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Helpful C++ Tools / Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling.html">Compiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_project.html">A First C++ Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="editors.html">Editors</a></li>
<li class="toctree-l1"><a class="reference internal" href="random-tools.html">Some Random Unix Tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++ Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cxx-datatypes.html">C++ Datatypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-vectors.html">Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-more-vectors.html">More Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-matrix-example.html">Example: Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-strings.html">Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-auto-decltype.html"><code class="docutils literal notranslate"><span class="pre">auto</span></code> and <code class="docutils literal notranslate"><span class="pre">decltype</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-structs.html">Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-arrays.html">Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-pointers.html">Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-statements.html">Loops and If-Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-io.html">File I/O</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cxx-functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-functions-example.html">More Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-orbit-example.html">Example: Planetary Orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-lambdas.html">Lambda Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-functions-planets.html">Example: Sorting Planets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Elements of Software Engineering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="multiple-files.html">Working with Multiple Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="make.html">Makefiles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cxx-classes-intro.html">Introduction to Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-vector2d-class.html">Example: Mathematical Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="contiguous_array.html">Example: Multidimensional Contiguous Array</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Some Random Bits...</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cxx-iomanip.html">I/O Manipulators</a></li>
<li class="toctree-l1"><a class="reference internal" href="operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="floating-point.html">Floating Point</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Testing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Unit Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#unit-tests-for-vector2d">Unit tests for <code class="docutils literal notranslate"><span class="pre">Vector2d</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-vectors">Comparing vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-tests">Writing tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automating-with-make">Automating with make</a></li>
<li class="toctree-l2"><a class="reference internal" href="#continuous-integration-and-github">Continuous integration and github</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cxx-convergence-tests.html">Convergence Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="valgrind.html">Valgrind</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="clang-tidy.html">clang-tidy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Digging Deeper into C++ Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="object-oriented.html">Object-Oriented Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="inheritance-and-access.html">Inheritance and Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="this-class.html"><code class="docutils literal notranslate"><span class="pre">this</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="copy_and_assignment.html">Copy, Assignment, and Destructors</a></li>
<li class="toctree-l1"><a class="reference internal" href="compound-operators.html">Compound Assignment Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-move.html">Move Semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-allocating.html">Allocating Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-simple-container.html">Example: A Simple Container</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documenting Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="html-css.html">HTML + CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="github-pages.html">Github Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="doxygen.html">Doxygen</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx.html">Sphinx</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Templates</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="templates-intro.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-template-array.html">Example: Templated Array</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates-more.html">More On Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="functionals.html">Function Objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Some Numerical Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="roots.html">Root Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="monte-carlo.html">Monte Carlo Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="poisson-relax.html">Poisson Equation and Relaxation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parallel Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parallel-intro.html">Introduction to Parallel Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="trivially-parallel.html">Trivially Parallel + BASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmp-intro.html">OpenMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmp-relax.html">OpenMP Poisson Relaxation</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmp-pi.html">OpenMP Monte Carlo <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi-intro.html">MPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi-sendrecv.html">MPI Send and Receive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">To Be Continued...</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="didnt_cover.html">Stuff We Didn’t Cover</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Homework</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="homework/homework1.html">Homework 1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="project.html">Final Project</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PHY 504</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Unit Testing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cxx-unit-tests.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="unit-testing">
<h1>Unit Testing<a class="headerlink" href="#unit-testing" title="Link to this heading"></a></h1>
<section id="unit-tests-for-vector2d">
<h2>Unit tests for <code class="docutils literal notranslate"><span class="pre">Vector2d</span></code><a class="headerlink" href="#unit-tests-for-vector2d" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are a lot of unit testing frameworks for C++ programs (for
example, <a class="reference external" href="https://github.com/catchorg/Catch2">Catch2</a>).  We are just going to
something simple here.</p>
</div>
<p>We can use the basic <code class="docutils literal notranslate"><span class="pre">assert</span></code> statement together with a makefile target to automate testing.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code class="docutils literal notranslate"><span class="pre">assert</span></code> will end the execution at the first failure.  We could
instead keep track of the number of failures and explicitly return
that as the return value of <code class="docutils literal notranslate"><span class="pre">main</span></code>, with <code class="docutils literal notranslate"><span class="pre">0</span></code> signifying all tests
passing.</p>
</div>
<p>We’ll do this with our <code class="docutils literal notranslate"><span class="pre">Vector2d</span></code> class.</p>
<p>The basic structure we will use is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// create some vectors v1 and v2</span>

<span class="w">    </span><span class="c1">// do some operations on v1 and v2</span>

<span class="w">    </span><span class="c1">// assert the result</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Ideally, we’d like to be able to capture the success of our test in a
Bash script, so let’s start by checking what the return value of a
program that failed an <code class="docutils literal notranslate"><span class="pre">assert</span></code> is</p>
<p>Consider the following:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cassert&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">   </span><span class="n">assert</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Let’s build and run that, and then check the return code via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1"><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span></span>
</pre></div></div><p>On my machine, I get <code class="docutils literal notranslate"><span class="pre">134</span></code>, but the actual code may vary depending
on the compiler and OS.  The key however is that it is non-zero.  This
means that we can test for a non-zero return in a script.</p>
</section>
<section id="comparing-vectors">
<h2>Comparing vectors<a class="headerlink" href="#comparing-vectors" title="Link to this heading"></a></h2>
<p>To make life easier, we’d like to be able to check if two vectors are
equal, using <code class="docutils literal notranslate"><span class="pre">==</span></code>, and not equal, using <code class="docutils literal notranslate"><span class="pre">!=</span></code>.</p>
<p>So we want to overload those operators and add them to our class:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span><span class="w"> </span><span class="k">operator</span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Vector2d</span><span class="o">&amp;</span><span class="w"> </span><span class="n">vec</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">vec</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">vec</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span><span class="w"> </span><span class="k">operator</span><span class="o">!=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Vector2d</span><span class="o">&amp;</span><span class="w"> </span><span class="n">vec</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">vec</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">vec</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">const</span></code> after the argument list allows these to be used on a
<code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">Vector2d</span></code> object.</p>
<p>These should be added directly to the class in <code class="docutils literal notranslate"><span class="pre">vector2d.H</span></code>.</p>
</section>
<section id="writing-tests">
<h2>Writing tests<a class="headerlink" href="#writing-tests" title="Link to this heading"></a></h2>
<p>Let’s write some basic tests:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">Listing 60 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">unit_test_vector2d.cpp</span></code></span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;vector2d.H&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cassert&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// test addition</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;testing addition&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">v1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// test subtraction</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;testing subraction&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">v1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// test unary minus</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;testing unary minus&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="o">-</span><span class="n">v1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// test not equal</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;testing inequality&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">v1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">v2</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// test the setters and the default constructor</span>

<span class="w">    </span><span class="n">v1</span><span class="p">.</span><span class="n">set_x</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span>
<span class="w">    </span><span class="n">v1</span><span class="p">.</span><span class="n">set_y</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;testing setters&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">v1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Vector2d</span><span class="p">());</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;all tests passed&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>These tests cover most of the functionality we explicitly implemented
in <code class="docutils literal notranslate"><span class="pre">vector2d.H</span></code>.  As written, they should all pass.</p>
</section>
<section id="automating-with-make">
<h2>Automating with make<a class="headerlink" href="#automating-with-make" title="Link to this heading"></a></h2>
<p>We’d like to provide a way to automate these tests.  Our first method
will be via <code class="docutils literal notranslate"><span class="pre">make</span></code> that we can run on our own computer.</p>
<p>Let’s start with the general <code class="docutils literal notranslate"><span class="pre">GNUmakefile</span></code> we developed in our
<a class="reference internal" href="make.html#sec-makefiles"><span class="std std-ref">Makefiles</span></a> section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a <a class="reference external" href="https://www.gnu.org/software/make/manual/html_node/Shell-Function.html?">GNU make shell function</a>
that looks like it might work, but that actually expands the command
and then tries to execute the output.</p>
</div>
<p>Here’s what the rule would look like:</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nf">testing</span><span class="o">:</span><span class="w"> </span><span class="n">unit_test_vector</span>2<span class="n">d</span>
<span class="w">     </span>./unit_test_vector2d<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="w">     </span>@if<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$$</span>?<span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;tests passed&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
</pre></div>
</div>
<p>After we run our command (we redirect <code class="docutils literal notranslate"><span class="pre">stdout</span></code> to <code class="docutils literal notranslate"><span class="pre">/dev/null</span></code> to
make it quiet) we use an <code class="docutils literal notranslate"><span class="pre">if-then</span></code> statement to check the output.
Note the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> at the start of the line makes it so <code class="docutils literal notranslate"><span class="pre">make</span></code> doesn’t
print the command itself to the screen, just the output.</p>
<p>Here’s the full version:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-number">Listing 61 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">GNUmakefile</span></code></span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="c"># by default, make will try to build the first target it encounters.</span>
<span class="c"># here we make up a dummy name &quot;ALL&quot; (note: this is not a special make</span>
<span class="c"># name, it is just commonly used).</span>

<span class="nf">ALL</span><span class="o">:</span><span class="w"> </span><span class="n">unit_test_vector</span>2<span class="n">d</span>

<span class="c"># find all of the source files and header files</span>

<span class="nv">SOURCES</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">$(</span>wildcard<span class="w"> </span>*.cpp<span class="k">)</span>
<span class="nv">HEADERS</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">$(</span>wildcard<span class="w"> </span>*.H<span class="k">)</span>

<span class="c"># create a list of object files by replacing .cpp with .o</span>

<span class="nv">OBJECTS</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">$(</span>SOURCES:.cpp<span class="o">=</span>.o<span class="k">)</span>

<span class="c"># a recipe for making an object file from a .cpp file</span>
<span class="c"># Note: this makes every header file a dependency of every object file,</span>
<span class="c"># which is not ideal, but it is safe.</span>

<span class="nf">%.o </span><span class="o">:</span><span class="w"> </span>%.<span class="n">cpp</span> ${<span class="n">HEADERS</span>}
<span class="w">	</span>g++<span class="w"> </span>-c<span class="w"> </span>$&lt;

<span class="c"># explicitly write the rule for linking together the executable</span>

<span class="nf">unit_test_vector2d</span><span class="o">:</span><span class="w"> </span>${<span class="n">OBJECTS</span>}
<span class="w">	</span>g++<span class="w"> </span>-o<span class="w"> </span><span class="nv">$@</span><span class="w"> </span><span class="si">${</span><span class="nv">OBJECTS</span><span class="si">}</span>

<span class="nf">testing</span><span class="o">:</span><span class="w"> </span><span class="n">unit_test_vector</span>2<span class="n">d</span>
<span class="w">	</span>./unit_test_vector2d<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="w">	</span>@if<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$$</span>?<span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;tests passed&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
</pre></div>
</div>
</div>
<div class="admonition-try-it admonition">
<p class="admonition-title">try it…</p>
<p>Let’s make a test fail in our <code class="docutils literal notranslate"><span class="pre">unit_test_vector2d.cpp</span></code> and make sure that this still works.</p>
</div>
</section>
<section id="continuous-integration-and-github">
<h2>Continuous integration and github<a class="headerlink" href="#continuous-integration-and-github" title="Link to this heading"></a></h2>
<p>For a large project, with multiple developers, we often want to ensure
that any changes that they make to the code still pass all of the
tests before we merge it into the <code class="docutils literal notranslate"><span class="pre">main</span></code> git branch.  This is called
<em>continuous integration</em>.  Github has a feature called <a class="reference external" href="https://docs.github.com/en/actions">Github actions</a> that allow us to set up simple
scripts that run on all pull requests.</p>
<p>We’ll look at how this can work – this is a high level overview of
the process that we will experiment with.  Usually one of the main
developers of a large project will have already implemented the
testing.</p>
<p>We’ll use this repository: <a class="reference external" href="https://github.com/phy504-sbu-s24/unit_tests">https://github.com/phy504-sbu-s24/unit_tests</a></p>
<p>There are a few places to look:</p>
<ul>
<li><p>The github action itself is a <a class="reference external" href="https://en.wikipedia.org/wiki/YAML">YAML</a> file:
<a class="reference external" href="https://github.com/phy504-sbu-s24/unit_tests/blob/main/.github/workflows/cxx-unit-tests.yml">https://github.com/phy504-sbu-s24/unit_tests/blob/main/.github/workflows/cxx-unit-tests.yml</a></p>
<p>This is placed in the repository in the <code class="docutils literal notranslate"><span class="pre">.github/workflows/</span></code> directory</p>
</li>
<li><p>The action runs on all pull requests.  You can see the status of all actions
that have run here: <a class="reference external" href="https://github.com/phy504-sbu-s24/unit_tests/actions">https://github.com/phy504-sbu-s24/unit_tests/actions</a></p></li>
</ul>
<div class="admonition-try-it admonition">
<p class="admonition-title">try it…</p>
<p>Let’s break the code and issue a pull request to see the action in action…</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A Github action is used to build this lecture notes from the ReST source
in the lecture note repo: <a class="reference external" href="https://github.com/zingale/phy504">https://github.com/zingale/phy504</a></p>
<p>This is that action: <a class="reference external" href="https://github.com/zingale/phy504/blob/main/.github/workflows/gh-pages.yml">https://github.com/zingale/phy504/blob/main/.github/workflows/gh-pages.yml</a></p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="testing.html" class="btn btn-neutral float-left" title="Testing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cxx-convergence-tests.html" class="btn btn-neutral float-right" title="Convergence Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2024, Michael Zingale.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>